<!doctype html>
<html class="theme-next use-motion theme-next-mist">
<head>
  

<meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>


<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />






  <link rel="stylesheet" type="text/css" href="/vendors/fancybox/source/jquery.fancybox.css?v=2.1.5"/>




<link rel="stylesheet" type="text/css" href="/css/main.css?v=0.4.5.1"/>


    <meta name="description" content="奋斗在Code Farm的在校生" />



  <meta name="keywords" content="函数式编程," />



  <link rel="alternate" href="/atom.xml" title="Forec's Notes" type="application/atom+xml" />



  <link rel="shorticon icon" type="image/x-icon" href="/favicon.ico?v=0.4.5.1" />


<meta name="description" content="There’re many interesting features in Haskell, here I want to introduce and analyse the Fixed-point combinator, which spent me several hours understanding but only scratched the surface.">
<meta property="og:type" content="article">
<meta property="og:title" content="Fix in Haskell">
<meta property="og:url" content="http://forec.github.io/2016/10/08/haskell-fixit/index.html">
<meta property="og:site_name" content="Forec's Notes">
<meta property="og:description" content="There’re many interesting features in Haskell, here I want to introduce and analyse the Fixed-point combinator, which spent me several hours understanding but only scratched the surface.">
<meta property="og:updated_time" content="2016-10-08T16:04:33.967Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Fix in Haskell">
<meta name="twitter:description" content="There’re many interesting features in Haskell, here I want to introduce and analyse the Fixed-point combinator, which spent me several hours understanding but only scratched the surface.">


<script type="text/javascript" id="hexo.configuration">
  var CONFIG = {
    scheme: 'Mist',
    sidebar: 'post'
  };
</script>

  <title> Fix in Haskell | Forec's Notes </title>
</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  <!--[if lte IE 8]>
  <div style=' clear: both; height: 59px; padding:0 0 0 15px; position: relative;margin:0 auto;'>
    <a href="http://windows.microsoft.com/en-US/internet-explorer/products/ie/home?ocid=ie6_countdown_bannercode">
      <img src="http://7u2nvr.com1.z0.glb.clouddn.com/picouterie.jpg" border="0" height="42" width="820"
           alt="You are using an outdated browser. For a faster, safer browsing experience, upgrade for free today or use other browser ,like chrome firefox safari."
           style='margin-left:auto;margin-right:auto;display: block;'/>
    </a>
  </div>
<![endif]-->
  



  <div class="container one-column page-post-detail">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><h1 class="site-meta">
  <span class="logo-line-before"><i></i></span>
  <a href="/" class="brand" rel="start">
      <span class="logo">
        <i class="icon-next-logo"></i>
      </span>
      <span class="site-title">Forec's Notes</span>
  </a>
  <span class="logo-line-after"><i></i></span>
</h1>

<div class="site-nav-toggle">
  <button>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
  </button>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu menu-left">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            <i class="menu-item-icon icon-next-home"></i> <br />
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories" rel="section">
            <i class="menu-item-icon icon-next-categories"></i> <br />
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about" rel="section">
            <i class="menu-item-icon icon-next-about"></i> <br />
            关于
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives" rel="section">
            <i class="menu-item-icon icon-next-archives"></i> <br />
            归档
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags" rel="section">
            <i class="menu-item-icon icon-next-tags"></i> <br />
            标签
          </a>
        </li>
      

      
      
    </ul>
  

  
    <div class="site-search">
      
  
  <form class="site-search-form">
    <input type="text" id="st-search-input" class="st-search-input st-default-search-input" />
  </form>


<script type="text/javascript">
  (function(w,d,t,u,n,s,e){w['SwiftypeObject']=n;w[n]=w[n]||function(){
    (w[n].q=w[n].q||[]).push(arguments);};s=d.createElement(t);
    e=d.getElementsByTagName(t)[0];s.async=1;s.src=u;e.parentNode.insertBefore(s,e);
  })(window,document,'script','//s.swiftypecdn.com/install/v2/st.js','_st');

  _st('install', 'xnW5noRB_qqRPttFz3nG','2.0.0');
</script>



    </div>
  
</nav>

 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div id="content" class="content"> 

  <div id="posts" class="posts-expand">
    

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <header class="post-header">

      
      
        <h1 class="post-title" itemprop="name headline">
          
          
            
              Fix in Haskell
            
          
        </h1>
      

      <div class="post-meta">
        <span class="post-time">
          发表于
          <time itemprop="dateCreated" datetime="2016-10-08T14:48:19+08:00" content="2016-10-08">
            2016-10-08
          </time>
        </span>

        
          <span class="post-category" >
            &nbsp; | &nbsp; 分类于
            
              <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                <a href="/categories/Language/" itemprop="url" rel="index">
                  <span itemprop="name">Language</span>
                </a>
              </span>

              
              

            
          </span>
        

        
          
            <span class="post-comments-count">
              &nbsp; | &nbsp;
              <a href="/2016/10/08/haskell-fixit/#comments" itemprop="discussionUrl">
                <span class="post-comments-count ds-thread-count" data-thread-key="2016/10/08/haskell-fixit/" itemprop="commentsCount"></span>
              </a>
            </span>
          
        
      </div>
    </header>

    <div class="post-body">

      
      

      
        <span itemprop="articleBody"><blockquote>
<p>There’re many interesting features in Haskell, here I want to introduce and analyse the <code>Fixed-point combinator</code>, which spent me several hours understanding but only scratched the surface. </p>
</blockquote>
<a id="more"></a>
<h1 id="Definition-Of-Fix"><a href="#Definition-Of-Fix" class="headerlink" title="Definition Of Fix"></a>Definition Of Fix</h1><ul>
<li>You can find the definition of <code>Fix</code> function in <a href="https://en.wikibooks.org/wiki/Haskell/Fix_and_recursion" target="_blank" rel="external">wiki</a>. The definition is<figure class="highlight haskell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="title">fix</span> :: (a -&gt; a) -&gt; a</span><br><span class="line"><span class="title">fix</span> f = <span class="keyword">let</span> x = f x <span class="keyword">in</span> x</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h1 id="Fix-And-Recursion"><a href="#Fix-And-Recursion" class="headerlink" title="Fix And Recursion"></a>Fix And Recursion</h1><ul>
<li><p>It seems a little confused. What does <code>let x = f x in x</code> mean? For example, <code>GNU</code> is <code>GNU is not Unix</code>, so how could you expand <code>GNU</code>? <code>GNU GNU GNU ... GNU is not Unix</code>? Another example, <code>let x = (1:) x in x</code>, what will x like? A list of infinite 1. Still confused? You can try <code>let x = x + 2 in x</code>, this will cause an exception because of stack overflow. The reason is that the <code>(+2)</code> operation is expanded constantly. So what is <code>fix</code> exactly? <code>Fix</code> can be imported from <code>Control.Monad.Fix</code>, its definition has been given above.</p>
</li>
<li><p>Now we can learn the power of <code>Fix</code> from an example. The <code>fact</code> is used to calculate <code>factorial</code>, here we calculate 5!. There are two kind of implements, the first is common recursion, like first line below. Instead, we can use <code>Fix</code> to rewrite it. We pass a lambda function to fix as a parameter, the lambda function receives <code>rec</code> and <code>n</code> as parameters, <code>rec</code> here is abstracted and it was initialized by <code>if n == 0 then 1</code>, this is indeed initialized for the lambda function, however you can think it as an anonymous <code>rec</code>.</p>
<figure class="highlight haskell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">Prelude</span>&gt; <span class="keyword">let</span> fact n = <span class="keyword">if</span> n == <span class="number">0</span> <span class="keyword">then</span> <span class="number">1</span> <span class="keyword">else</span> n * fact (n-<span class="number">1</span>) <span class="keyword">in</span> fact <span class="number">5</span></span><br><span class="line"><span class="number">120</span></span><br><span class="line"><span class="type">Prelude</span>&gt; fix (\<span class="keyword">rec</span> n -&gt; <span class="keyword">if</span> n == <span class="number">0</span> <span class="keyword">then</span> <span class="number">1</span> <span class="keyword">else</span> n * <span class="keyword">rec</span> (n-<span class="number">1</span>)) <span class="number">5</span></span><br><span class="line"><span class="number">120</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>In fact, from the definition of <code>Fix</code>, we know that <code>fix</code> means a fixed-point. What we need to do is to write the equation for <code>fix</code> like below. <code>Fix</code> is used to find a fixed-point for given function.  </p>
<figure class="highlight haskell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="title">f</span> (fix f) = fix f</span><br></pre></td></tr></table></figure>
</li>
<li><p>So why <code>fix (+2)</code> is getting an exception? There is no <code>x</code> for <code>x == x + 2</code>, so <code>fix</code> cannot find an fixed-point for <code>(+2). That&#39;s why</code>fix<code>finally came into stack overflow. Now we are going to learn what</code>fix<code>works in details. We can expand</code>fix` like below.</p>
<figure class="highlight haskell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="title">fix</span> (<span class="number">2</span>+)</span><br><span class="line">= <span class="number">2</span> + (fix (<span class="number">2</span>+))</span><br><span class="line">= <span class="number">2</span> + (<span class="number">2</span> + fix (<span class="number">2</span>+))</span><br><span class="line">= <span class="number">2</span> + (<span class="number">2</span> + (<span class="number">2</span> + fix (<span class="number">2</span>+)))</span><br><span class="line">= <span class="number">2</span> + (<span class="number">2</span> + (<span class="number">2</span> + (<span class="number">2</span> + fix (<span class="number">2</span>+))))</span><br><span class="line">= ...</span><br><span class="line"></span><br><span class="line"><span class="title">fix</span> (<span class="number">1</span>:)</span><br><span class="line">= <span class="number">1</span> : fix (<span class="number">1</span>:)</span><br><span class="line">= <span class="number">1</span> : (<span class="number">1</span> : fix (<span class="number">1</span>:))</span><br><span class="line">= <span class="number">1</span> : (<span class="number">1</span> : (<span class="number">1</span> : fix (<span class="number">1</span>:)))</span><br></pre></td></tr></table></figure>
</li>
<li><p>As you can see, <code>fix (1:)</code> can work fine since the lazy evaluation of Haskell. If we pass <code>fix (1:)</code> to <code>show</code>, <code>GHCI</code> can still work and output <code>[1, 1, 1, ...</code>. Return to the <code>fact</code> example now, how does it work? We write that lambda function passed to <code>fix</code> as a named function <code>fact&#39;</code> here, the definition is <code>fact&#39; rec n = if n == 0 then 1 else n * rec (n-1)</code>. Pass this to <code>fix</code>, fix will find a fixed-point of <code>fact&#39;</code>, which is the function <code>f</code> such that <code>f == fact&#39; f</code>. So we can write <code>fact&#39;</code> like below.</p>
<figure class="highlight haskell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="title">f</span> = fact' f</span><br><span class="line">  = \n -&gt; <span class="keyword">if</span> n == <span class="number">0</span> <span class="keyword">then</span> <span class="number">1</span> <span class="keyword">else</span> n * f (n-<span class="number">1</span>)</span><br></pre></td></tr></table></figure>
</li>
<li><p>Are you familiar with the equation above? The <code>f</code> substitute <code>rec</code> in <code>fact&#39;</code>, and <code>f</code> also acts as <code>fact&#39; f</code>, which is just recursion. So expand <code>fix</code> as we always did. (Codes below are copied from wiki)</p>
<figure class="highlight haskell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="title">fix</span> fact'</span><br><span class="line">= fact' (fix fact')</span><br><span class="line">= (\<span class="keyword">rec</span> n -&gt; <span class="keyword">if</span> n == <span class="number">0</span> <span class="keyword">then</span> <span class="number">1</span> <span class="keyword">else</span> n * <span class="keyword">rec</span> (n-<span class="number">1</span>)) (fix fact')</span><br><span class="line">= \n -&gt; <span class="keyword">if</span> n == <span class="number">0</span> <span class="keyword">then</span> <span class="number">1</span> <span class="keyword">else</span> n * fix fact' (n-<span class="number">1</span>)</span><br><span class="line">= \n -&gt; <span class="keyword">if</span> n == <span class="number">0</span> <span class="keyword">then</span> <span class="number">1</span> <span class="keyword">else</span> n * fact' (fix fact') (n-<span class="number">1</span>)</span><br><span class="line">= \n -&gt; <span class="keyword">if</span> n == <span class="number">0</span> <span class="keyword">then</span> <span class="number">1</span></span><br><span class="line">        <span class="keyword">else</span> n * (\<span class="keyword">rec</span> n' -&gt; <span class="keyword">if</span> n' == <span class="number">0</span> <span class="keyword">then</span> <span class="number">1</span> <span class="keyword">else</span> n' * <span class="keyword">rec</span> (n'-<span class="number">1</span>)) (fix fact') (n-<span class="number">1</span>)</span><br><span class="line">= \n -&gt; <span class="keyword">if</span> n == <span class="number">0</span> <span class="keyword">then</span> <span class="number">1</span></span><br><span class="line">        <span class="keyword">else</span> n * (<span class="keyword">if</span> n-<span class="number">1</span> == <span class="number">0</span> <span class="keyword">then</span> <span class="number">1</span> <span class="keyword">else</span> (n-<span class="number">1</span>) * fix fact' (n-<span class="number">2</span>))</span><br><span class="line">= \n -&gt; <span class="keyword">if</span> n == <span class="number">0</span> <span class="keyword">then</span> <span class="number">1</span></span><br><span class="line">        <span class="keyword">else</span> n * (<span class="keyword">if</span> n-<span class="number">1</span> == <span class="number">0</span> <span class="keyword">then</span> <span class="number">1</span></span><br><span class="line">                  <span class="keyword">else</span> (n-<span class="number">1</span>) * (<span class="keyword">if</span> n-<span class="number">2</span> == <span class="number">0</span> <span class="keyword">then</span> <span class="number">1</span></span><br><span class="line">                                <span class="keyword">else</span> (n-<span class="number">2</span>) * fix fact' (n-<span class="number">3</span>)))</span><br><span class="line">= ...</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h1 id="Implementation-Of-Foldr-amp-Reverse"><a href="#Implementation-Of-Foldr-amp-Reverse" class="headerlink" title="Implementation Of Foldr &amp; Reverse"></a>Implementation Of Foldr &amp; Reverse</h1><ul>
<li><p>I am going to show some of the applications of <code>fix</code>. First is <code>reverse</code>. We can write <code>reverse&#39;</code> as the parameter of <code>fix</code>. The type system of <code>reverse&#39;</code> is <code>([a] -&gt;[a]) -&gt; ([a] -&gt; [a])</code>. Notice that I use a pair of parentheses out of <code>[a] -&gt; [a]</code>, that’s because curry. <code>reverse&#39;</code> is just like <code>fact&#39;</code>, it receives a function <code>f</code>, and <code>fix</code> is going to find a <code>f</code> which satisfies <code>f = reverse&#39; f</code>. Now we can easily write <code>reverse&#39;</code> below.</p>
<figure class="highlight haskell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="title">reverse'</span> :: ([a] -&gt; [a]) -&gt; ([a] -&gt; [a])</span><br><span class="line"><span class="title">reverse'</span> f [] = []</span><br><span class="line"><span class="title">reverse'</span> f (x:xs) = f xs ++ [x]</span><br><span class="line"></span><br><span class="line"><span class="title">reverse</span> = fix reverse'</span><br><span class="line"></span><br><span class="line"><span class="comment">-- expand the definition above</span></span><br><span class="line">(fix reverse') [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>]</span><br><span class="line">= (reverse' (fix reverse')) [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>]</span><br><span class="line">= (reverse' f) [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>]</span><br><span class="line">= f [<span class="number">2</span>,<span class="number">3</span>] ++ [<span class="number">1</span>]</span><br><span class="line">= (reverse' f) [<span class="number">2</span>,<span class="number">3</span>] ++ [<span class="number">1</span>]</span><br><span class="line">= ...</span><br></pre></td></tr></table></figure>
</li>
<li><p>Another example I am going to talk is <code>foldr</code>. I found the kata about <code>fix</code> in Codewars, you can see it <a href="https://www.codewars.com/kata/fix-it/haskell" target="_blank" rel="external">here</a>. I didn’t pass the time limitation, and finally I got clues from conversations. There are several ways to write <code>foldr</code> by <code>fix</code>, however, you need to maintain the feature of <code>foldr</code>, the lazy evaluation. I will show two of them both satisfying the lazy evaluation.</p>
<figure class="highlight haskell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="title">foldr'</span> :: ((a -&gt;b -&gt;b) -&gt;b -&gt;[a] -&gt;b) -&gt;((a -&gt;b -&gt;b) -&gt;b -&gt;[a] -&gt;b)</span><br><span class="line"><span class="title">foldr'</span> f g acc [] = acc</span><br><span class="line"><span class="title">foldr'</span> f g acc (x:xs) = f g (g x acc) xs</span><br><span class="line"></span><br><span class="line"><span class="title">foldr'</span> :: ((a -&gt;b -&gt;b) -&gt;b -&gt;[a] -&gt;b) -&gt;((a -&gt;b-&gt; b) -&gt;b -&gt;[a] -&gt;b)</span><br><span class="line"><span class="title">foldr'</span> f g acc [] = acc</span><br><span class="line"><span class="title">foldr'</span> f g acc (x:xs) = g x (f g acc xs)</span><br><span class="line"></span><br><span class="line"><span class="title">foldr</span> = fix foldr'</span><br></pre></td></tr></table></figure>
</li>
<li><p>Which is better? In my own opinion, the first is better since it is written in  a format of tail-end recursion. This would not expand the stack space it used. However, the second needs to expand until the end of the list. But, after my experiment testing big integers, both of them met stack overflow at the same size while works as same as each other when they can deal with the parameters. This proved that my thought was wrong. So, why the two formats have same performance? Stay for thought.</p>
</li>
</ul>
<hr>
<p>I hope this article could give you some help. If this article has any error, or you have some problems/suggestions, please <a href="mailto:forec@bupt.edu.cn" target="_blank" rel="external">e-mail me</a>. I am glad to learn from each other.</p>
<p>原创作品，允许转载，转载时无需告知，但请务必以超链接形式标明文章<a href="https://forec.github.io/2016/10/08/haskell-fixit/">原始出处</a>(<a href="https://forec.github.io/2016/10/08/haskell-fixit/">https://forec.github.io/2016/10/08/haskell-fixit/</a>) 、作者信息（<a href="https://forec.github.io/">Forec</a>）和本声明。</p>
</span>
      
    </div>

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/函数式编程/" rel="tag">#函数式编程</a>
          
        </div>
      

      
        <div class="post-nav">
          <div class="post-nav-prev post-nav-item">
            
          </div>

          <div class="post-nav-next post-nav-item">
            
              <a href="/2016/10/03/co-occurrence-structure-capture/" rel="next">Network Mining Based On Co-occurrence</a>
            
          </div>
        </div>
      

      
      
    </footer>
  </article>



    <div class="post-spread">
      
    </div>
  </div>

 </div>

        

        
          <div class="comments" id="comments">
            
              <div class="ds-thread" data-thread-key="2016/10/08/haskell-fixit/"
                   data-title="Fix in Haskell" data-url="http://forec.github.io/2016/10/08/haskell-fixit/">
              </div>
            
          </div>
        
      </div>

      
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap" >
            文章目录
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview">
            站点概览
          </li>
        </ul>
      

      <section class="site-overview">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" src="/uploads/avatar.jpg" alt="Forec" itemprop="image"/>
          <p class="site-author-name" itemprop="name">Forec</p>
        </div>
        <p class="site-description motion-element" itemprop="description">奋斗在Code Farm的在校生</p>
        <nav class="site-state motion-element">
          <div class="site-state-item site-state-posts">
            <a href="/archives">
              <span class="site-state-item-count">50</span>
              <span class="site-state-item-name">日志</span>
            </a>
          </div>

          <div class="site-state-item site-state-categories">
            <a href="/categories">
              <span class="site-state-item-count">9</span>
              <span class="site-state-item-name">分类</span>
              </a>
          </div>

          <div class="site-state-item site-state-tags">
            <a href="/tags">
              <span class="site-state-item-count">19</span>
              <span class="site-state-item-name">标签</span>
              </a>
          </div>

        </nav>

        
          <div class="feed-link motion-element">
            <a href="/atom.xml" rel="alternate">
              <i class="menu-item-icon icon-next-feed"></i>
              RSS
            </a>
          </div>
        

        <div class="links-of-author motion-element">
          
            
              <span class="links-of-author-item">
                <a href="https://github.com/forec" target="_blank">github</a>
              </span>
            
              <span class="links-of-author-item">
                <a href="http://www.codewars.com/users/Forec" target="_blank">codewars</a>
              </span>
            
              <span class="links-of-author-item">
                <a href="mailto:forec@bupt.edu.cn" target="_blank">email</a>
              </span>
            
              <span class="links-of-author-item">
                <a href="http://www.zhihu.com/people/forect" target="_blank">zhihu</a>
              </span>
            
          
        </div>

        
        

        <div class="links-of-author motion-element">
          
            <p class="site-author-name">友情链接</p>
            
              <span class="links-of-author-item">
              <a href="https://fallenwood.github.io" target="_blank">Fallenwood的博客</a>
              </span>
            
          
        </div>

      </section>

      
        <section class="post-toc-wrap sidebar-panel-active">
          <div class="post-toc-indicator-top post-toc-indicator"></div>
          <div class="post-toc">
            
            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#Definition-Of-Fix"><span class="nav-number">1.</span> <span class="nav-text">Definition Of Fix</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Fix-And-Recursion"><span class="nav-number">2.</span> <span class="nav-text">Fix And Recursion</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Implementation-Of-Foldr-amp-Reverse"><span class="nav-number">3.</span> <span class="nav-text">Implementation Of Foldr & Reverse</span></a></li></ol></div>
            
          </div>
          <div class="post-toc-indicator-bottom post-toc-indicator"></div>
        </section>
      

    </div>
  </aside>


    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner"> <div class="copyright" >
  
  &copy; &nbsp;  2015 - 
  <span itemprop="copyrightYear">2016</span>
  <span class="with-love">
    <i class="icon-next-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Forec</span>
</div>

<script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js">
</script>

<span id="busuanzi_container_site_pv">
    本站总访问量<span id="busuanzi_value_site_pv"></span>次
</span>


 </div>
    </footer>

    <div class="back-to-top"></div>
  </div>

  <script type="text/javascript" src="/vendors/jquery/index.js?v=2.1.3"></script>

  
  
  
    

  
    
  

  <script type="text/javascript">
    var duoshuoQuery = {short_name:"forec"};
    (function() {
      var ds = document.createElement('script');
      ds.type = 'text/javascript';ds.async = true;
      ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
      ds.charset = 'UTF-8';
      (document.getElementsByTagName('head')[0]
      || document.getElementsByTagName('body')[0]).appendChild(ds);
    })();
  </script>
    
     
  	<script src="/js/ua-parser.min.js"></script>
  	<script src="/js/hook-duoshuo.js"></script>
  

    
  
  
  <script type="text/javascript" src="/vendors/fancybox/source/jquery.fancybox.pack.js"></script>
  <script type="text/javascript" src="/js/fancy-box.js?v=0.4.5.1"></script>


  <script type="text/javascript" src="/js/helpers.js?v=0.4.5.1"></script>
  

  <script type="text/javascript" src="/vendors/velocity/velocity.min.js"></script>
  <script type="text/javascript" src="/vendors/velocity/velocity.ui.min.js"></script>

  <script type="text/javascript" src="/js/motion_global.js?v=0.4.5.1" id="motion.global"></script>



  <script type="text/javascript" src="/js/nav-toggle.js"></script>

  
  
<script type="text/javascript" src="/js/bootstrap.scrollspy.js?v=0.4.5.1" id="bootstrap.scrollspy.custom"></script>


<script type="text/javascript" id="sidebar.toc.highlight">
  $(document).ready(function () {
    var tocSelector = '.post-toc';
    var $tocSelector = $(tocSelector);
    var activeCurrentSelector = '.active-current';

    $tocSelector
      .on('activate.bs.scrollspy', function () {
        var $currentActiveElement = $(tocSelector + ' .active').last();

        removeCurrentActiveClass();
        $currentActiveElement.addClass('active-current');

        $tocSelector[0].scrollTop = $currentActiveElement.position().top;
      })
      .on('clear.bs.scrollspy', function () {
        removeCurrentActiveClass();
      });

    function removeCurrentActiveClass () {
      $(tocSelector + ' ' + activeCurrentSelector)
        .removeClass(activeCurrentSelector.substring(1));
    }

    function processTOC () {
      getTOCMaxHeight();
      toggleTOCOverflowIndicators();
    }

    function getTOCMaxHeight () {
      var height = $('.sidebar').height() -
                   $tocSelector.position().top -
                   $('.post-toc-indicator-bottom').height();

      $tocSelector.css('height', height);

      return height;
    }

    function toggleTOCOverflowIndicators () {
      tocOverflowIndicator(
        '.post-toc-indicator-top',
        $tocSelector.scrollTop() > 0 ? 'show' : 'hide'
      );

      tocOverflowIndicator(
        '.post-toc-indicator-bottom',
        $tocSelector.scrollTop() >= $tocSelector.find('ol').height() - $tocSelector.height() ? 'hide' : 'show'
      )
    }

    $(document).on('sidebar.motion.complete', function () {
      processTOC();
    });

    $('body').scrollspy({ target: tocSelector });
    $(window).on('resize', function () {
      if ( $('.sidebar').hasClass('sidebar-active') ) {
        processTOC();
      }
    });

    onScroll($tocSelector);

    function onScroll (element) {
      element.on('mousewheel DOMMouseScroll', function (event) {
          var oe = event.originalEvent;
          var delta = oe.wheelDelta || -oe.detail;

          this.scrollTop += ( delta < 0 ? 1 : -1 ) * 30;
          event.preventDefault();

          toggleTOCOverflowIndicators();
      });
    }

    function tocOverflowIndicator (indicator, action) {
      var $indicator = $(indicator);
      var opacity = action === 'show' ? 0.4 : 0;
      $indicator.velocity ?
        $indicator.velocity('stop').velocity({
          opacity: opacity
        }, { duration: 100 }) :
        $indicator.stop().animate({
          opacity: opacity
        }, 100);
    }

  });
</script>

<script type="text/javascript" id="sidebar.nav">
  $(document).ready(function () {
    var html = $('html');
    var TAB_ANIMATE_DURATION = 200;
    var hasVelocity = $.isFunction(html.velocity);

    $('.sidebar-nav li').on('click', function () {
      var item = $(this);
      var activeTabClassName = 'sidebar-nav-active';
      var activePanelClassName = 'sidebar-panel-active';
      if (item.hasClass(activeTabClassName)) {
        return;
      }

      var currentTarget = $('.' + activePanelClassName);
      var target = $('.' + item.data('target'));

      hasVelocity ?
        currentTarget.velocity('transition.slideUpOut', TAB_ANIMATE_DURATION, function () {
          target
            .velocity('stop')
            .velocity('transition.slideDownIn', TAB_ANIMATE_DURATION)
            .addClass(activePanelClassName);
        }) :
        currentTarget.animate({ opacity: 0 }, TAB_ANIMATE_DURATION, function () {
          currentTarget.hide();
          target
            .stop()
            .css({'opacity': 0, 'display': 'block'})
            .animate({ opacity: 1 }, TAB_ANIMATE_DURATION, function () {
              currentTarget.removeClass(activePanelClassName);
              target.addClass(activePanelClassName);
            });
        });

      item.siblings().removeClass(activeTabClassName);
      item.addClass(activeTabClassName);
    });

    $('.post-toc a').on('click', function (e) {
      e.preventDefault();
      var targetSelector = escapeSelector(this.getAttribute('href'));
      var offset = $(targetSelector).offset().top;
      hasVelocity ?
        html.velocity('stop').velocity('scroll', {
          offset: offset  + 'px',
          mobileHA: false
        }) :
        $('html, body').stop().animate({
          scrollTop: offset
        }, 500);
    });

    // Expand sidebar on post detail page by default, when post has a toc.
    var $tocContent = $('.post-toc-content');
    if (isDesktop() && CONFIG.sidebar === 'post') {
      if ($tocContent.length > 0 && $tocContent.html().trim().length > 0) {
        displaySidebar();
      }
    }
  });
</script>



  <script type="text/javascript">
    $(document).ready(function () {
      if (CONFIG.sidebar === 'always') {
        displaySidebar();
      }
    });
  </script>

  
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    tex2jax: {
      inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
      processEscapes: true,
      skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
    }
  });
</script>

<script type="text/x-mathjax-config">
  MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for (i=0; i < all.length; i += 1) {
      all[i].SourceElement().parentNode.className += ' has-jax';
    }
  });
</script>

<script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>


  
  

  
  <script type="text/javascript" src="/js/lazyload.js"></script>
  <script type="text/javascript">
    $(function () {
      $("#posts").find('img').lazyload({
        placeholder: "/images/loading.gif",
        effect: "fadeIn"
      });
    });
  </script>
</body>
</html>
